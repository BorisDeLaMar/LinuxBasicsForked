# Принципы организации IP сетей  
***Как устроен стек IP сетей?***  
Две наиболее популярные классификации уровней стека - **модель OSI (7 уровней)** и **RFC 1122**.  
## RFC 1122  
Уровни стека TCP/IP сверху-вниз:  
+ Application layer (прикладной). На этом уровне работают прикладные протоколы: **SMTP**, **telnet**, **http** и другие
+ Transport layer - **TCP**, **UDP** - основные протоколы для доставки данных от одного узла другому в сети Интернет
+ Internet layer (сетевой) - основной уровень организации сети Интернет. На этом уровне работает протокол **IP**, определяющий как структуру пакетов,
передающихся между узлами, так и различные правила, по которым выполняется адресация узлов и сетей. На этом же уровне работают **ICMP** (команда `ping`,
ошибка недоступности хоста) - протокол управляющих сообщений (Internet Control Message Protocol), **ARP** и **RARP** - протоколы трансляции адресов
(Reverse Address Resolution Protocol), позволяющие реализовывать адреса ip в mac-адреса (то есть они осуществляют взаимодействие Internet и Link слоев).
Также на этом уровне работает группа протоколо маршрутизации, которые определяют правила пересылки данных между сегментами сети.
+ Link layer - уровень, на котором взаимодействуют устройства, объединенные коммуникационными каналами (медный кабель/оптоволокно/радиоволны).
Адреса на этом уровне - mac-адреса (Media Access Control).
## OSI  
OSI - модель, описывающая не конкретно стек TCP/IP, а просто произвольные виды сетевого взаимодействия между узлами. Эта модель референсная (обобщенная) и синтетическая.  

Уровни OSI снизу-вверх:
+ Физический - определяет то, как формируются и передаются сигналы в физической среде
+ Data link - определяет то, как устройства, непосредственно соединенные какой-то физической средой находят друг друга (**адресуются**) и как они обеспечивают передачу данных (низкоуровневый протокол через физическую среду).
+ Сетевой - позволяет строить сети, разделять адресное пространство, разделять узлы на группы и строить между ними коммуникации. То есть, это уровень организации сетей, уровень их архитектуры. Фактически, на этом уровне определяются группы узлов, которые могут иметь смысл логической сети, и правила маршрутизации (правила передачи данных между узлами, находящихся в разных группах) Аналогичен сетевому в RFC 1122.
+ Транспортный : **UDP** позволяет передевать данные в виде пакетов, **TCP** - потоковая передача (для чего нужна **сессия** - соединение двух узлов),
 поэтому транспортная составляющая относится и к UDP, и к TCP.
+ Сеансовый (session) - TCP
+ Presentation layer (представления)
+ Application layer (прикладной) - вместе с Presentation layer являются, по сути, одним уровнем: уровнем приложений и тех протоколов и форматов данных, которые
они используют для того, чтобы взаимодействовать. Например, взамодействие сервера потокового видео и плеера.

***Для чего нужна многоуровневость модели?***  
Слои друш от друга не зависят, то есть, например, можем поменять Wi-Fi на Ethernet, и это произойдет независимо от других слоев.

*NB На каждом уровне стека TCP/IP своя система адресов узлов взаимодействующих сторон (в физическое - MAC, на сетевом - IP/IPX/IPv6, на транспортном - IP:port или более сложные комбинации, на прикладном - доменное имя/email/ICQID...). Переходя от уровня к уровню, существуют средства трансляции трансляции адресов с одного уровня на другой как сверху, так и снизу.*    
## Программные уровни в терминологии сетей   
+ Уровень аппаратуры - сетевые адаптеры - аналог физического уровня стека TCP/IP
+ Драйверы - как сетевых адаптеров, так и сетевых протоколов (например, TCP)
+ ОС с ее системным  интерфейсом. Системный интерфейс для любых сетевых взаимодействий - **интерфейс сокетов**.
***Что такое сокет и какие действия он абстрагирует?***
Сокет абстрагирует *сетевой адрес* (за сокетом скрыто конкретное семейство адресов и способ организации сети), *транспорт* (позволяет управлять им), предоставляет базовые операции ввода-вывода (открытие/закрытие соединения, запись [посылка]/чтение [получение] данных).
Сокеты отличаются для разных семейств адресов. Для семейства адресов TCP/IP сокет связан, как правило, с парой IP:port.

## Принципы организации IP сетей на примере IPv4  
Для адресации каждого узла по такому протоколу необходимо 4 байта. Для группировки компьютеров в рамках логической сети используют **маски подсети**.  
*NB Запись 192.168.13.5/24 означает, что 24 бита занято под маску подсети. Также макса должна быть непрерывной, т.е не может быть 255.0.255.0*  

Компьютер C2 имеет 2 сетевых платы с разными адресами (2 сетевых интерфейса). Передать данные напрямую с C1 на C3 не можем адже если они через провод соединены, так как находятся в разных логических сетях. Если такая передача нужна, то C2 должен выступить в роли **маршрутизатора**. Для C1 и C3, при этом, он будет **шлюзом** или **gateway**.  
*NB HUB (или switch), физически, - маленький компьютер, а логически - просто провод, позволяющий соединить физически все 3 компьютера.*
![Снимок экрана (337)](https://github.com/BorisDeLaMar/LinuxBasicsForked/assets/91004615/f588b2d9-6af8-4c0f-bd85-77f1b66c87e7)
