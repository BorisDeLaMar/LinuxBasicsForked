# 3.2 Создание процессов fork/exec  

Именно родитель инициирует создание нового процесса.  

## Алгоритм создания нового процесса  
1) `fork` текущего процесса - создание точной копии текущего процесса (родителя), за исключением некоторых деталей
2) `exec` - замещает образ текущего процесса новым образом процесса-потомка
Родитель и потомок должны быть созданы разными бинырными файлами (образами), поэтому родитель копирует себя и замещает весь свой образ (условно память) на содержимое
образа нового процесса - потомка. Если быть точнее, то это (атрибуты) меняет ядро ОС
## Про fork  
`fork` клонирует родителя, и эта копия должна стать процессом-потомком, поэтому некоторые атрибуты у такого клона другие: **pid**, **ppid**; 
потомок не наследует *блокировки памяти родителя*, *список сигналов*, ожидающих обработки, и *таймеры*, а также некоторые другие атрибуты.    
В `man fork` также можно найти информацию о том, что если потомок создан успешно, его `pid` будет возвращен родителю, а ему самому - 0. 
Это нужно, поскольку возвращаемся из `fork` мы как в родителе (он получает child's pid), так и в потомке, поскольку он - точная копия родителя со своим `fork`.
Это впоследствие также позволяет командой `exec` затереть память именно в потомке.  
## Про exec  
В `man exec` можно увидеть, что `exec` - семейство функций, у каждой из которых свой набор аргументов.  
Так или иначе, `exec` затирает память процесса новым образом (исполняемым файлом, exe-шником) и полностью инициализирует необходимые атрибуты процесса для того, 
чтобы передать ему управление, сделать его по-настоящему живым.  

`man 2 execve` - описание системного вызова, соответствующего семейству функций `exec`.  

*NB Есть два способа создания процесса в Linux:*
+ *из скриптовых файлов, то есть, указав интерпретатор и набор конструкций на языке этого интерпретатора*
+ *из бинарных файлов исполняемых модулей*
## Семейство функций wait  
`man wait` - функция, используемая после fork в родителе. Пока процесс-потомок не завершит свою работу, родителя можно отправить в ожидание.  
Если мы не будем ждать завершения потомка, в системе могут начать накапливаться *зондби*, так как не гарантируем получение *кода возврата*.
